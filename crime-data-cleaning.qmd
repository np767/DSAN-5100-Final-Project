---
title: "DSAN 5100 Project. Crime Data"
author: Pavlos Baffes
format: html
---

```{r}
library(tidyverse)

# Load aggravated assaul data
agg_crime_ca <- read_csv("crime-data-5100/Aggravated-assault-California.csv")
agg_crime_fl <- read_csv("crime-data-5100/Aggravated-assault-Florida.csv")
agg_crime_ny <- read_csv("crime-data-5100/Aggravated-assault-New-York.csv")
agg_crime_mi <- read_csv("crime-data-5100/Aggravated-assault-Michigan.csv")
agg_crime_pa <- read_csv("crime-data-5100/Aggravated-assault-Pennsylvania.csv")
agg_crime_tx <- read_csv("crime-data-5100/Aggravated-assault-Texas.csv")
agg_crime_us <- read_csv("crime-data-5100/Aggravated-assault-US.csv")


# Load Homicide data

hom_crime_ca <- read_csv("crime-data-5100/Homicide-California.csv")
hom_crime_fl <- read_csv("crime-data-5100/Homicide-Florida.csv")
hom_crime_ny <- read_csv("crime-data-5100/Homicide-New-York.csv")
hom_crime_mi <- read_csv("crime-data-5100/Homicide-Michigan.csv")
hom_crime_pa <- read_csv("crime-data-5100/Homicide-Pennsylvania.csv")
hom_crime_tx <- read_csv("crime-data-5100/Homicide-Texas.csv")
hom_crime_us <- read_csv("crime-data-5100/Homicide-US.csv")
```

```{r}

library(tidyverse)

# Load Rape Data

rp_crime_ca <- read_csv("crime-data-5100/Rape-California.csv")
rp_crime_fl <- read_csv("crime-data-5100/Rape-Florida.csv")
rp_crime_ny <- read_csv("crime-data-5100/Rape-New-York.csv")
rp_crime_mi <- read_csv("crime-data-5100/Rape-Michigan.csv")
rp_crime_pa <- read_csv("crime-data-5100/Rape-Pennsylvania.csv")
rp_crime_tx <- read_csv("crime-data-5100/Rape-Texas.csv")
rp_crime_us <- read_csv("crime-data-5100/Rape-US.csv")

# Load Robbery Data

rob_crime_ca <- read_csv("crime-data-5100/Robbery-California.csv")
rob_crime_fl <- read_csv("crime-data-5100/Robbery-Florida.csv")
rob_crime_ny <- read_csv("crime-data-5100/Robbery-New-York.csv")
rob_crime_mi <- read_csv("crime-data-5100/Robbery-Michigan.csv")
rob_crime_pa <- read_csv("crime-data-5100/Robbery-Pennsylvania.csv")
rob_crime_tx <- read_csv("crime-data-5100/Robbery-Texas.csv")
rob_crime_us <- read_csv("crime-data-5100/Robbery-US.csv")
```



```{r}
list_df_agg <- list(agg_crime_ca, agg_crime_fl, agg_crime_ny, agg_crime_mi, agg_crime_pa, agg_crime_tx, agg_crime_us)

# Create tibble to hold all aggravated assault data
full_df_agg <- tibble(
    State = character(),
    Month_Year = character(),
    aggravated_assault_count = double()
)

# Bind all the states and US together to make 1 tibble
for (i in list_df_agg){

    # Rename column to state
    i <- i |> rename(State = Series)

    # delete row 2 since it is not needed
    i <- i[-2, ]

    # pivot longer to get in proper format
    i <- i |> pivot_longer(cols = !State, names_to = "Month_Year", values_to = "aggravated_assault_count")

    full_df_agg <- rbind(i, full_df_agg)
}

```

```{r}
list_df_hom <- list(hom_crime_ca, hom_crime_fl, hom_crime_ny, hom_crime_mi, hom_crime_pa, hom_crime_tx, hom_crime_us)

# Create tibble to hold all Homicide data
full_df_hom <- tibble(
    State = character(),
    Month_Year = character(),
    homicide_count = double()
)

# Bind all the states and US together to make 1 tibble
for (i in list_df_hom){

    # Rename column to state
    i <- i |> rename(State = Series)

    # delete row 2 since it is not needed
    i <- i[-2, ]

    # pivot longer to get in proper format
    i <- i |> pivot_longer(cols = !State, names_to = "Month_Year", values_to = "homicide_count")

    full_df_hom <- rbind(i, full_df_hom)
}
```

```{r}

list_df_rp <- list(rp_crime_ca, rp_crime_fl, rp_crime_ny, rp_crime_mi, rp_crime_pa, rp_crime_tx, rp_crime_us)

# Create tibble to hold all Rape data
full_df_rp <- tibble(
    State = character(),
    Month_Year = character(),
    homicide_count = double()
)

# Bind all the states and US together to make 1 tibble
for (i in list_df_rp){

    # Rename column to state
    i <- i |> rename(State = Series)

    # delete row 2 since it is not needed
    i <- i[-2, ]

    # pivot longer to get in proper format
    i <- i |> pivot_longer(cols = !State, names_to = "Month_Year", values_to = "rape_count")

    full_df_rp <- rbind(i, full_df_rp)
}

```

```{r}

list_df_rob <- list(rob_crime_ca, rob_crime_fl, rob_crime_ny, rob_crime_mi, rob_crime_pa, rob_crime_tx, rob_crime_us)

# Create tibble to hold all Robbery data
full_df_rob <- tibble(
    State = character(),
    Month_Year = character(),
    homicide_count = double()
)

# Bind all the states and US together to make 1 tibble
for (i in list_df_rob){

    # Rename column to state
    i <- i |> rename(State = Series)

    # delete row 2 since it is not needed
    i <- i[-2, ]

    # pivot longer to get in proper format
    i <- i |> pivot_longer(cols = !State, names_to = "Month_Year", values_to = "robbery_count")

    full_df_rob <- rbind(i, full_df_rob)
}

```

```{r}

# Join all crime data together to create final crime_df

crime_df <- full_df_agg |>
            left_join(full_df_hom, by =c("State", "Month_Year")) |>
            left_join(full_df_rp, by =c("State", "Month_Year")) |>
            left_join(full_df_rob, by =c("State", "Month_Year"))

```

```{r}

# Pull in U.S. population 

```