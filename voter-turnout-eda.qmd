---
title: "Voter Turnout Exploratory Data Analysis"
author: Group 6
date: today
format:
  html:
    code-fold: true
    toc: true
    toc-depth: 3
    theme: cosmo
execute:
  warning: false
  message: false
---

# Setup

```{r}
library(tidyverse)
library(ggplot2)
library(dplyr)
library(plotly)

# Define consistent state colors
state_colors <- c(
  "California" = "#FDB927",    # Gold (Golden State)
  "Florida" = "#FF8C00",        # Dark Orange (Sunshine State)
  "Michigan" = "#00274C",       # Navy Blue (University of Michigan)
  "New York" = "#003DA5",       # Royal Blue (NY blue)
  "Ohio" = "#BB0000",           # Scarlet Red (Ohio State)
  "Utah" = "#8B4513"            # Saddle Brown (Red rock landscape)
)
```

# Load Data

```{r}
# Load cleaned voter turnout data for selected states
voter_turnout <- read_csv("data/processed-data/voter_turnout_selected_states.csv")

# Preview data
head(voter_turnout)
glimpse(voter_turnout)
```

# Data Overview

```{r}
# Summary statistics
summary(voter_turnout)

```

# Visualizations

## Turnout Over Time

```{r}
# VEP turnout rate over time by state
plot_ly(voter_turnout, x = ~year, y = ~vep_turnout_rate, color = ~state,
        colors = state_colors,
        type = 'scatter', mode = 'lines+markers',
        line = list(width = 2),
        marker = list(size = 6),
        hovertemplate = paste0(
          '<b>%{fullData.name}</b><br>',
          'Year: %{x}<br>',
          'Turnout: %{y:.1%}<br>',
          '<extra></extra>'
        )) %>%
  layout(
    title = list(
      text = "Voter Turnout Rate Over Time by State<br><sub>Voting Eligible Population (VEP) Turnout Rate, 1980-2024</sub>",
      x = 0
    ),
    xaxis = list(title = "Year"),
    yaxis = list(title = "VEP Turnout Rate", tickformat = ".0%"),
    hovermode = "closest",
    legend = list(title = list(text = "State"))
  )
```

**Key Observations:**

- **Presidential election spikes**: All states show clear peaks in turnout during presidential election years (divisible by 4), with notably higher turnout in 2020 and 2024.
- **Midterm drops**: Midterm elections consistently show lower turnout across all states, typically 15-25 percentage points below presidential years.
- **State variations**: Michigan and Ohio tend to have higher overall turnout rates, while California and New York show lower average participation.
- **Recent trends**: Most states experienced increased turnout in 2020 and 2024 compared to previous presidential elections, potentially reflecting increased political engagement.


## Turnout by Election Type

```{r}
# Presidential vs Midterm elections - Overall
ggplot(voter_turnout, aes(x = election_type, y = vep_turnout_rate,
                           fill = election_type)) +
  geom_boxplot() +
  labs(
    title = "Voter Turnout: Presidential vs Midterm Elections",
    x = "Election Type",
    y = "VEP Turnout Rate"
  ) +
  scale_y_continuous(labels = scales::percent_format()) +
  theme_minimal() +
  theme(legend.position = "none")
```

**Key Observations:**

- **Substantial gap**: Presidential elections show a median turnout around 60-65%, while midterm elections show approximately 40-45% turnout.
- **Statistical significance**: The clear separation between the two distributions suggests a statistically significant difference in turnout between election types.
- **Variability**: Presidential elections show slightly more variability (wider spread) in turnout rates compared to midterms.


```{r}
# Presidential vs Midterm elections - By State
ggplot(voter_turnout, aes(x = election_type, y = vep_turnout_rate,
                           fill = election_type)) +
  geom_boxplot() +
  facet_wrap(~state, ncol = 3) +
  labs(
    title = "Voter Turnout: Presidential vs Midterm Elections by State",
    subtitle = "Comparing election types across six selected states",
    x = "Election Type",
    y = "VEP Turnout Rate"
  ) +
  scale_y_continuous(labels = scales::percent_format()) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    axis.text.x = element_text(angle = 45, hjust = 1)
  )
```

**Key Observations:**

- **Consistent patterns across states**: All six states show the same presidential-midterm gap, confirming this is a national pattern rather than state-specific.
- **Michigan leads**: Michigan shows the highest median turnout for both presidential and midterm elections among the selected states.
- **California variation**: California shows the largest spread in turnout rates, particularly for midterm elections, suggesting more volatility in voter engagement.
- **Florida data issues**: Florida's boxplot clearly shows outliers at near-zero turnout (the 1980-1990 data quality issue), visible as extreme lower outliers in the presidential election box.
- **State-specific differences**: While the presidential-midterm gap is consistent, the absolute turnout levels vary significantly by state, with Michigan and Ohio outperforming California and New York.

## State Comparisons

```{r}
# Average turnout by state
avg_turnout_by_state <- voter_turnout %>%
  group_by(state) %>%
  summarise(avg_turnout = mean(vep_turnout_rate, na.rm = TRUE)) %>%
  arrange(desc(avg_turnout))

ggplot(avg_turnout_by_state, aes(x = reorder(state, avg_turnout),
                                   y = avg_turnout, fill = state)) +
  geom_col() +
  labs(
    title = "Average Voter Turnout by State (1980-2024)",
    x = "State",
    y = "Average VEP Turnout Rate"
  ) +
  scale_fill_manual(values = state_colors) +
  scale_y_continuous(labels = scales::percent_format()) +
  theme_minimal() +
  theme(
    legend.position = "none",
    axis.text.x = element_text(angle = 0, hjust = 0.5)
  )
```

**Key Observations:**

- **Michigan leads** with the highest average turnout at approximately 59%, followed closely by Ohio at around 57%.
- **Geographic pattern**: Midwest states (Michigan, Ohio) show higher average turnout than coastal states (California, New York) in this sample.
- **California ranks lowest** among the selected states with an average turnout near 51%, despite being the most populous state.



## Voter Turnout Trends by State

```{r}

ggplot(voter_turnout, aes(x = year, y = vep_turnout_rate, color = election_type)) +
  geom_line(linewidth = 0.8) +
  geom_point(size = 1.5) +
  facet_wrap(~state, ncol = 2) +
  labs(
    title = "Voter Turnout Trends by State",
    x = "Year",
    y = "VEP Turnout Rate",
    color = "Election Type"
  ) +
  scale_y_continuous(labels = scales::percent_format()) +
  theme_minimal() +
  theme(legend.position = "bottom")
```

**Key Observations:**

- **Universal cyclical pattern**: All states exhibit the same sawtooth pattern of high presidential turnout followed by lower midterm turnout, confirming this is a systemic national phenomenon.
- **2020-2024 surge**: Most states show a notable increase in turnout for the 2020 and 2024 presidential elections compared to historical averages, with some states reaching their highest recorded turnout levels.
- **Declining midterm trend**: Several states (particularly California and New York) show a slight downward trend in midterm election turnout over the past two decades.
- **State-specific volatility**: California shows more variation in midterm turnout compared to other states, while Michigan's turnout appears more stable over time.
- **Recent convergence**: In 2020 and 2024, state turnout rates appear to be converging, with less variation between states than in earlier decades.

# Statistical Summary

```{r}
# Summary by state and election type
voter_turnout %>%
  group_by(state, election_type) %>%
  summarise(
    observations = n(),
    mean_turnout = mean(vep_turnout_rate, na.rm = TRUE),
    median_turnout = median(vep_turnout_rate, na.rm = TRUE),
    sd_turnout = sd(vep_turnout_rate, na.rm = TRUE),
    .groups = "drop"
  ) %>%
  arrange(state, election_type)
```

# Normalized Turnout Analysis

The normalized VEP turnout rate represents how much each election's turnout deviates from that state's average for that election type (presidential or midterm). Positive values indicate above-average turnout, while negative values indicate below-average turnout.

## Normalized Turnout Over Time

```{r}
# Interactive plot of normalized turnout over time
plot_ly(voter_turnout, x = ~year, y = ~normalized_vep_turnout, color = ~state,
        colors = state_colors,
        type = 'scatter', mode = 'lines+markers',
        line = list(width = 2),
        marker = list(size = 6),
        hovertemplate = paste0(
          '<b>%{fullData.name}</b><br>',
          'Year: %{x}<br>',
          'Normalized Turnout: %{y:.1%}<br>',
          '<extra></extra>'
        )) %>%
  layout(
    title = list(
      text = "Normalized VEP Turnout Over Time by State<br><sub>Deviation from State-Election Type Average</sub>",
      x = 0
    ),
    xaxis = list(title = "Year"),
    yaxis = list(title = "Normalized VEP Turnout (Deviation from Mean)", tickformat = ".0%"),
    hovermode = "closest",
    legend = list(title = list(text = "State")),
    shapes = list(
      list(
        type = "line",
        x0 = min(voter_turnout$year, na.rm = TRUE),
        x1 = max(voter_turnout$year, na.rm = TRUE),
        y0 = 0,
        y1 = 0,
        line = list(color = "black", dash = "dash", width = 1)
      )
    )
  )
```

**Key Observations:**

- **2020 and 2024 stand out**: Most states show positive normalized turnout (above their historical average) for the 2020 and 2024 presidential elections, indicating exceptional voter engagement in recent years.
- **Oscillating around zero**: The normalized values oscillate around the zero line (the reference line), which is expected since each state's data is centered around its own mean.
- **Identifying unusual elections**: Elections that deviate significantly from the zero line represent unusual mobilization (high positive) or suppression/disengagement (low negative) relative to that state's typical pattern.
- **State-specific patterns**: Some states show more volatility in normalized turnout (larger deviations from zero) than others, suggesting different levels of election-to-election stability.
- **Recent upward trend**: Many states show an upward trajectory in normalized turnout in recent years, particularly for presidential elections, suggesting increasing civic engagement.
- **Midterm stability**: Normalized midterm turnout appears more stable (smaller deviations) than presidential elections, indicating more consistent midterm voter behavior.

## Distribution of Normalized Turnout

```{r}
# Boxplot of normalized turnout by state and election type
ggplot(voter_turnout, aes(x = state, y = normalized_vep_turnout, fill = election_type)) +
  geom_boxplot(alpha = 0.7) +
  geom_hline(yintercept = 0, linetype = "dashed", color = "black", linewidth = 0.5) +
  labs(
    title = "Distribution of Normalized VEP Turnout by State and Election Type",
    subtitle = "How much each election deviates from that state's average",
    x = "State",
    y = "Normalized VEP Turnout (Deviation from Mean)",
    fill = "Election Type"
  ) +
  scale_y_continuous(labels = scales::percent_format()) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    axis.text.x = element_text(angle = 45, hjust = 1)
  )
```

**Key Observations:**

- **Centered at zero**: By design, each state-election type combination should have a mean of approximately zero (shown by the dashed reference line), confirming the normalization was successful.
- **California shows high variability**: California has the widest distribution of normalized turnout values for both election types, indicating the most volatile turnout patterns—some elections significantly exceed the average while others fall far below.
- **Michigan's consistency**: Michigan shows relatively tight distributions, suggesting more stable and predictable turnout patterns over time.
- **Presidential elections more variable**: For most states, presidential elections show wider distributions than midterm elections, indicating presidential years experience more dramatic swings in turnout relative to their averages.
- **Symmetric distributions**: Most distributions appear roughly symmetric around zero, suggesting turnout increases and decreases are balanced over time.
- **Outliers present**: A few states show outliers, representing elections with exceptionally unusual turnout—these.
- **Florida's extreme outliers**: Florida shows extreme negative outliers, again reflecting the 1980-1990 data quality issues.

